@startuml
set separator none
title Bond Math - Preview Deployment

top to bottom direction
skinparam ranksep 60
skinparam nodesep 30

skinparam {
  arrowFontSize 10
  defaultTextAlignment center
  wrapWidth 200
  maxMessageSize 100
}

hide stereotype

skinparam rectangle<<Preview.bondmathvaluationpreview.BondValuation_1>> {
  BackgroundColor #3776ab
  FontColor #ffffff
  BorderColor #265277
  shadowing false
}
skinparam rectangle<<Preview.bondmathdaycountpreview.Daycount_1>> {
  BackgroundColor #3178c6
  FontColor #ffffff
  BorderColor #22548a
  shadowing false
}
skinparam rectangle<<Preview.bondmathgatewaypreview.Gateway_1>> {
  BackgroundColor #3178c6
  FontColor #ffffff
  BorderColor #22548a
  shadowing false
}
skinparam rectangle<<Preview.bondmathmetricspreview.Metrics_1>> {
  BackgroundColor #3776ab
  FontColor #ffffff
  BorderColor #265277
  shadowing false
}
skinparam rectangle<<Preview.bondmathpricingpreview.Pricing_1>> {
  BackgroundColor #3776ab
  FontColor #ffffff
  BorderColor #265277
  shadowing false
}
skinparam rectangle<<Preview.bondmathui.Ui_1>> {
  BackgroundColor #dddddd
  FontColor #000000
  BorderColor #9a9a9a
  shadowing false
}
skinparam rectangle<<Preview.bondmathdaycountpreview>> {
  BackgroundColor #ffffff
  FontColor #000000
  BorderColor #888888
  shadowing false
}
skinparam rectangle<<Preview.bondmathgatewaypreview>> {
  BackgroundColor #ffffff
  FontColor #000000
  BorderColor #888888
  shadowing false
}
skinparam rectangle<<Preview.bondmathmetricspreview>> {
  BackgroundColor #ffffff
  FontColor #000000
  BorderColor #888888
  shadowing false
}
skinparam rectangle<<Preview.bondmathpricingpreview>> {
  BackgroundColor #ffffff
  FontColor #000000
  BorderColor #888888
  shadowing false
}
skinparam rectangle<<Preview.bondmathui>> {
  BackgroundColor #ffffff
  FontColor #000000
  BorderColor #888888
  shadowing false
}
skinparam rectangle<<Preview.bondmathvaluationpreview>> {
  BackgroundColor #ffffff
  FontColor #000000
  BorderColor #888888
  shadowing false
}

rectangle "bond-math-ui\n<size:10>[Deployment Node: Cloudflare Workers]</size>" <<Preview.bondmathui>> as Preview.bondmathui {
  rectangle "==Ui\n<size:10>[Container: Cloudflare Pages]</size>\n\nUser interface for bond math calculations - Astro static site with React islands" <<Preview.bondmathui.Ui_1>> as Preview.bondmathui.Ui_1
}

rectangle "bond-math-gateway-preview\n<size:10>[Deployment Node: Cloudflare Workers]</size>" <<Preview.bondmathgatewaypreview>> as Preview.bondmathgatewaypreview {
  rectangle "==Gateway\n<size:10>[Container: Cloudflare Workers (TypeScript)]</size>\n\nEntry point for all API traffic - handles Auth0 verification, internal JWT minting, and service routing" <<Preview.bondmathgatewaypreview.Gateway_1>> as Preview.bondmathgatewaypreview.Gateway_1
}

rectangle "bond-math-daycount-preview\n<size:10>[Deployment Node: Cloudflare Workers]</size>" <<Preview.bondmathdaycountpreview>> as Preview.bondmathdaycountpreview {
  rectangle "==Daycount\n<size:10>[Container: Cloudflare Workers (TypeScript)]</size>\n\nAuthoritative day-count and year-fraction calculations for fixed income" <<Preview.bondmathdaycountpreview.Daycount_1>> as Preview.bondmathdaycountpreview.Daycount_1
}

rectangle "bond-math-valuation-preview\n<size:10>[Deployment Node: Cloudflare Workers]</size>" <<Preview.bondmathvaluationpreview>> as Preview.bondmathvaluationpreview {
  rectangle "==Bond Valuation\n<size:10>[Container: Cloudflare Workers (Python)]</size>\n\nPrice â†” yield calculations and cashflow generation for bullet bonds" <<Preview.bondmathvaluationpreview.BondValuation_1>> as Preview.bondmathvaluationpreview.BondValuation_1
}

rectangle "bond-math-metrics-preview\n<size:10>[Deployment Node: Cloudflare Workers]</size>" <<Preview.bondmathmetricspreview>> as Preview.bondmathmetricspreview {
  rectangle "==Metrics\n<size:10>[Container: Cloudflare Workers (Python)]</size>\n\nBond risk metrics (duration, convexity, PV01, DV01)" <<Preview.bondmathmetricspreview.Metrics_1>> as Preview.bondmathmetricspreview.Metrics_1
}

rectangle "bond-math-pricing-preview\n<size:10>[Deployment Node: Cloudflare Workers]</size>" <<Preview.bondmathpricingpreview>> as Preview.bondmathpricingpreview {
  rectangle "==Pricing\n<size:10>[Container: Cloudflare Workers (Python)]</size>\n\nCurve-based cashflow discounting and present value calculations" <<Preview.bondmathpricingpreview.Pricing_1>> as Preview.bondmathpricingpreview.Pricing_1
}

Preview.bondmathgatewaypreview.Gateway_1 .[#707070,thickness=2].> Preview.bondmathpricingpreview.Pricing_1 : "<color:#707070>Uses\n<color:#707070><size:8>[Service Binding (internal-jwt)]</size>"
Preview.bondmathui.Ui_1 .[#707070,thickness=2].> Preview.bondmathgatewaypreview.Gateway_1 : "<color:#707070>Uses\n<color:#707070><size:8>[https (auth0-jwt)]</size>"
Preview.bondmathgatewaypreview.Gateway_1 .[#707070,thickness=2].> Preview.bondmathdaycountpreview.Daycount_1 : "<color:#707070>Uses\n<color:#707070><size:8>[Service Binding (internal-jwt)]</size>"
Preview.bondmathgatewaypreview.Gateway_1 .[#707070,thickness=2].> Preview.bondmathvaluationpreview.BondValuation_1 : "<color:#707070>Uses\n<color:#707070><size:8>[Service Binding (internal-jwt)]</size>"
Preview.bondmathgatewaypreview.Gateway_1 .[#707070,thickness=2].> Preview.bondmathmetricspreview.Metrics_1 : "<color:#707070>Uses\n<color:#707070><size:8>[Service Binding (internal-jwt)]</size>"
@enduml