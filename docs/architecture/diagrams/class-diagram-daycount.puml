@startuml
title Daycount - Class Diagram

skinparam classAttributeIconSize 0
skinparam linetype ortho

interface ActorClaim {
  iss: string
  sub: string
  role?: string
  perms: string[]
  org?: string
  uid?: string
}
note right of ActorClaim
  
Actor claim from internal JWT
Represents "Service X acting for User Y"
end note

interface DateComponents {
  year: number
  month: number
  day: number
}
note right of DateComponents
  
Parsed date components for calculations

end note

interface DatePair {
  start: string
  end: string
}
note right of DatePair
  
Date pair for year fraction calculation
end note

interface DayCountOptions {
  eomRule?: boolean
  frequency?: number
}
note right of DayCountOptions
  
Options for day-count calculations
end note

interface DayCountRequest {
  pairs: DatePair[]
  convention: DayCountConvention
  options?: DayCountOptions
  version?: string
}
note right of DayCountRequest
  
Request body for /api/daycount/v1/count endpoint
end note

interface DayCountResponse {
  results: DayCountResult[]
  convention: DayCountConvention
  version: string
}
note right of DayCountResponse
  
Response body for /api/daycount/v1/count endpoint
end note

interface DayCountResult {
  days: number
  yearFraction: number
  basis: number
}
note right of DayCountResult
  
Single day-count calculation result
end note

interface Env {
  INTERNAL_JWT_SECRET: string
  ENVIRONMENT?: string
}
note right of Env
  
Cloudflare Worker environment bindings
end note

interface ErrorResponse {
  type: string
  title: string
  status: number
  detail: string
  instance?: string
  errors?: Array<{
    field?: string;
    message: string;
  }>
}
note right of ErrorResponse
  
Standard error response following RFC 7807 Problem Details
end note

interface ValidationError {
  field: string
  message: string
}
note right of ValidationError
  
Validation error with field context
end note

interface Variables {
  requestId: string
  actor: ActorClaim
}
note right of Variables
  
Hono context variables
end note

' Relationships
DayCountRequest ..> DatePair : uses
DayCountRequest ..> DayCountOptions : uses
DayCountResponse ..> DayCountResult : uses
Variables ..> ActorClaim : uses

@enduml