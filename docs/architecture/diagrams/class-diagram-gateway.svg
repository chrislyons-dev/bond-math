<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="606px" preserveAspectRatio="none" style="width:6911px;height:606px;background:#FFFFFF;" version="1.1" viewBox="0 0 6911 606" width="6911px" zoomAndPan="magnify"><title>Gateway - Class Diagram</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="167.2959" x="3364.9724" y="24.5332">Gateway - Class Diagram</text><!--class ActorClaim--><g id="elem_ActorClaim"><rect codeLine="6" fill="#F1F1F1" height="153.6563" id="ActorClaim" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100.6895" x="10" y="428.1094"/><ellipse cx="25.1055" cy="444.1094" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M26.0586,440.75 L26.0586,447.4063 L27.7773,447.4063 Q28.3867,447.4063 28.6523,447.6406 Q28.918,447.875 28.918,448.2656 Q28.918,448.6406 28.6523,448.875 Q28.3867,449.1094 27.7773,449.1094 L22.6367,449.1094 Q22.0273,449.1094 21.7617,448.875 Q21.4961,448.6406 21.4961,448.25 Q21.4961,447.875 21.7617,447.6406 Q22.0273,447.4063 22.6367,447.4063 L24.3555,447.4063 L24.3555,440.75 L22.6367,440.75 Q22.0273,440.75 21.7617,440.5156 Q21.4961,440.2813 21.4961,439.8906 Q21.4961,439.5156 21.7617,439.2813 Q22.0273,439.0469 22.6367,439.0469 L27.7773,439.0469 Q28.3867,439.0469 28.6523,439.2813 Q28.918,439.5156 28.918,439.8906 Q28.918,440.2813 28.6523,440.5156 Q28.3867,440.75 27.7773,440.75 L26.0586,440.75 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="68.4551" x="39.1289" y="449.8379">ActorClaim</text><line style="stroke:#181818;stroke-width:0.5;" x1="11" x2="109.6895" y1="460.1094" y2="460.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.124" x="16" y="478.6426">iss: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64.5859" x="16" y="496.252">sub: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73.1445" x="16" y="513.8613">role?: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88.6895" x="16" y="531.4707">perms: string[]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70.0342" x="16" y="549.0801">org?: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68.4824" x="16" y="566.6895">uid?: string</text><line style="stroke:#181818;stroke-width:0.5;" x1="11" x2="109.6895" y1="573.7656" y2="573.7656"/></g><g id="elem_GMN3"><path d="M146,483.6094 L146,501.6094 L111.19,505.6094 L146,509.6094 L146,526.3125 A0,0 0 0 0 146,526.3125 L473.1602,526.3125 A0,0 0 0 0 473.1602,526.3125 L473.1602,493.6094 L463.1602,483.6094 L146,483.6094 A0,0 0 0 0 146,483.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M463.1602,483.6094 L463.1602,493.6094 L473.1602,493.6094 L463.1602,483.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.2236" x="152" y="502.1045">&#160;&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306.1602" x="152" y="518.4561">Actor claim - represents "Service X acting for User Y"</text></g><!--class Auth0Claims--><g id="elem_Auth0Claims"><rect codeLine="19" fill="#F1F1F1" height="171.2656" id="Auth0Claims" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="144.2686" x="382.5" y="112.6094"/><ellipse cx="412.3065" cy="128.6094" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M413.2596,125.25 L413.2596,131.9063 L414.9784,131.9063 Q415.5877,131.9063 415.8534,132.1406 Q416.119,132.375 416.119,132.7656 Q416.119,133.1406 415.8534,133.375 Q415.5877,133.6094 414.9784,133.6094 L409.8377,133.6094 Q409.2284,133.6094 408.9627,133.375 Q408.6971,133.1406 408.6971,132.75 Q408.6971,132.375 408.9627,132.1406 Q409.2284,131.9063 409.8377,131.9063 L411.5565,131.9063 L411.5565,125.25 L409.8377,125.25 Q409.2284,125.25 408.9627,125.0156 Q408.6971,124.7813 408.6971,124.3906 Q408.6971,124.0156 408.9627,123.7813 Q409.2284,123.5469 409.8377,123.5469 L414.9784,123.5469 Q415.5877,123.5469 415.8534,123.7813 Q416.119,124.0156 416.119,124.3906 Q416.119,124.7813 415.8534,125.0156 Q415.5877,125.25 414.9784,125.25 L413.2596,125.25 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="79.3652" x="429.5968" y="134.3379">Auth0Claims</text><line style="stroke:#181818;stroke-width:0.5;" x1="383.5" x2="525.7686" y1="144.6094" y2="144.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.124" x="388.5" y="163.1426">iss: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64.5859" x="388.5" y="180.752">sub: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118.8018" x="388.5" y="198.3613">aud: string | string[]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77.8203" x="388.5" y="215.9707">exp: number</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70.0342" x="388.5" y="233.5801">iat: number</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.1582" x="388.5" y="251.1895">scope?: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132.2686" x="388.5" y="268.7988">permissions?: string[]</text><line style="stroke:#181818;stroke-width:0.5;" x1="383.5" x2="525.7686" y1="275.875" y2="275.875"/></g><g id="elem_GMN7"><path d="M561.5,176.6094 L561.5,194.6094 L526.58,198.6094 L561.5,202.6094 L561.5,219.3125 A0,0 0 0 0 561.5,219.3125 L791.2744,219.3125 A0,0 0 0 0 791.2744,219.3125 L791.2744,186.6094 L781.2744,176.6094 L561.5,176.6094 A0,0 0 0 0 561.5,176.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M781.2744,176.6094 L781.2744,186.6094 L791.2744,186.6094 L781.2744,176.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.2236" x="567.5" y="195.1045">&#160;&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208.7744" x="567.5" y="211.4561">Auth0 JWT claims (after verification)</text></g><!--class Env--><g id="elem_Env"><rect codeLine="37" fill="#F1F1F1" height="241.7031" id="Env" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="312.2959" x="826.5" y="77.1094"/><ellipse cx="966.3359" cy="93.1094" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M967.2891,89.75 L967.2891,96.4063 L969.0078,96.4063 Q969.6172,96.4063 969.8828,96.6406 Q970.1484,96.875 970.1484,97.2656 Q970.1484,97.6406 969.8828,97.875 Q969.6172,98.1094 969.0078,98.1094 L963.8672,98.1094 Q963.2578,98.1094 962.9922,97.875 Q962.7266,97.6406 962.7266,97.25 Q962.7266,96.875 962.9922,96.6406 Q963.2578,96.4063 963.8672,96.4063 L965.5859,96.4063 L965.5859,89.75 L963.8672,89.75 Q963.2578,89.75 962.9922,89.5156 Q962.7266,89.2813 962.7266,88.8906 Q962.7266,88.5156 962.9922,88.2813 Q963.2578,88.0469 963.8672,88.0469 L969.0078,88.0469 Q969.6172,88.0469 969.8828,88.2813 Q970.1484,88.5156 970.1484,88.8906 Q970.1484,89.2813 969.8828,89.5156 Q969.6172,89.75 969.0078,89.75 L967.2891,89.75 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="24.124" x="986.8359" y="98.8379">Env</text><line style="stroke:#181818;stroke-width:0.5;" x1="827.5" x2="1137.7959" y1="109.1094" y2="109.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151.6963" x="832.5" y="127.6426">AUTH0_DOMAIN: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="168.041" x="832.5" y="145.252">AUTH0_AUDIENCE: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="220.1582" x="832.5" y="162.8613">INTERNAL_JWT_SECRET?: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="296.3857" x="832.5" y="180.4707">INTERNAL_JWT_SECRET_CURRENT?: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="300.2959" x="832.5" y="198.0801">INTERNAL_JWT_SECRET_PREVIOUS?: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="188.2617" x="832.5" y="215.6895">INTERNAL_JWT_TTL?: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="153.248" x="832.5" y="233.2988">ENVIRONMENT?: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="170.3721" x="832.5" y="250.9082">SVC_DAYCOUNT: Fetcher</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="171.165" x="832.5" y="268.5176">SVC_VALUATION: Fetcher</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154.8135" x="832.5" y="286.127">SVC_METRICS: Fetcher</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150.1514" x="832.5" y="303.7363">SVC_PRICING: Fetcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="827.5" x2="1137.7959" y1="310.8125" y2="310.8125"/></g><g id="elem_GMN11"><path d="M1174,176.6094 L1174,194.6094 L1138.7,198.6094 L1174,202.6094 L1174,219.3125 A0,0 0 0 0 1174,219.3125 L1405.2471,219.3125 A0,0 0 0 0 1405.2471,219.3125 L1405.2471,186.6094 L1395.2471,176.6094 L1174,176.6094 A0,0 0 0 0 1174,176.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1395.2471,176.6094 L1395.2471,186.6094 L1405.2471,186.6094 L1395.2471,176.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.2236" x="1180" y="195.1045">&#160;&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210.2471" x="1180" y="211.4561">Type definitions for Gateway Worker</text></g><!--class ErrorResponse--><g id="elem_ErrorResponse"><rect codeLine="55" fill="#F1F1F1" height="136.0469" id="ErrorResponse" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126.1514" x="1440.5" y="130.1094"/><ellipse cx="1455.5" cy="146.1094" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1456.4531,142.75 L1456.4531,149.4063 L1458.1719,149.4063 Q1458.7813,149.4063 1459.0469,149.6406 Q1459.3125,149.875 1459.3125,150.2656 Q1459.3125,150.6406 1459.0469,150.875 Q1458.7813,151.1094 1458.1719,151.1094 L1453.0313,151.1094 Q1452.4219,151.1094 1452.1563,150.875 Q1451.8906,150.6406 1451.8906,150.25 Q1451.8906,149.875 1452.1563,149.6406 Q1452.4219,149.4063 1453.0313,149.4063 L1454.75,149.4063 L1454.75,142.75 L1453.0313,142.75 Q1452.4219,142.75 1452.1563,142.5156 Q1451.8906,142.2813 1451.8906,141.8906 Q1451.8906,141.5156 1452.1563,141.2813 Q1452.4219,141.0469 1453.0313,141.0469 L1458.1719,141.0469 Q1458.7813,141.0469 1459.0469,141.2813 Q1459.3125,141.5156 1459.3125,141.8906 Q1459.3125,142.2813 1459.0469,142.5156 Q1458.7813,142.75 1458.1719,142.75 L1456.4531,142.75 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="94.1514" x="1469.5" y="151.8379">ErrorResponse</text><line style="stroke:#181818;stroke-width:0.5;" x1="1441.5" x2="1565.6514" y1="162.1094" y2="162.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68.4756" x="1446.5" y="180.6426">type: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.7998" x="1446.5" y="198.252">title: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.5996" x="1446.5" y="215.8613">status: number</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75.4824" x="1446.5" y="233.4707">detail: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101.9443" x="1446.5" y="251.0801">instance?: string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1441.5" x2="1565.6514" y1="258.1563" y2="258.1563"/></g><g id="elem_GMN15"><path d="M1601.5,176.6094 L1601.5,194.6094 L1566.65,198.6094 L1601.5,202.6094 L1601.5,219.3125 A0,0 0 0 0 1601.5,219.3125 L1865.2661,219.3125 A0,0 0 0 0 1865.2661,219.3125 L1865.2661,186.6094 L1855.2661,176.6094 L1601.5,176.6094 A0,0 0 0 0 1601.5,176.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1855.2661,176.6094 L1855.2661,186.6094 L1865.2661,186.6094 L1855.2661,176.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.2236" x="1607.5" y="195.1045">&#160;&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242.7661" x="1607.5" y="211.4561">RFC 7807 Problem Details error response</text></g><!--class InternalJWT--><g id="elem_InternalJWT"><rect codeLine="67" fill="#F1F1F1" height="153.6563" id="InternalJWT" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="107.4619" x="7" y="121.1094"/><ellipse cx="22" cy="137.1094" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M22.9531,133.75 L22.9531,140.4063 L24.6719,140.4063 Q25.2813,140.4063 25.5469,140.6406 Q25.8125,140.875 25.8125,141.2656 Q25.8125,141.6406 25.5469,141.875 Q25.2813,142.1094 24.6719,142.1094 L19.5313,142.1094 Q18.9219,142.1094 18.6563,141.875 Q18.3906,141.6406 18.3906,141.25 Q18.3906,140.875 18.6563,140.6406 Q18.9219,140.4063 19.5313,140.4063 L21.25,140.4063 L21.25,133.75 L19.5313,133.75 Q18.9219,133.75 18.6563,133.5156 Q18.3906,133.2813 18.3906,132.8906 Q18.3906,132.5156 18.6563,132.2813 Q18.9219,132.0469 19.5313,132.0469 L24.6719,132.0469 Q25.2813,132.0469 25.5469,132.2813 Q25.8125,132.5156 25.8125,132.8906 Q25.8125,133.2813 25.5469,133.5156 Q25.2813,133.75 24.6719,133.75 L22.9531,133.75 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="75.4619" x="36" y="142.8379">InternalJWT</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="113.4619" y1="153.1094" y2="153.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.124" x="13" y="171.6426">iss: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64.5859" x="13" y="189.252">sub: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65.3721" x="13" y="206.8613">aud: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77.8203" x="13" y="224.4707">exp: number</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5723" x="13" y="242.0801">rid: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94.9102" x="13" y="259.6895">act: ActorClaim</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="113.4619" y1="266.7656" y2="266.7656"/></g><g id="elem_GMN19"><path d="M149.5,176.6094 L149.5,194.6094 L114.12,198.6094 L149.5,202.6094 L149.5,219.3125 A0,0 0 0 0 149.5,219.3125 L347.5171,219.3125 A0,0 0 0 0 347.5171,219.3125 L347.5171,186.6094 L337.5171,176.6094 L149.5,176.6094 A0,0 0 0 0 149.5,176.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M337.5171,176.6094 L337.5171,186.6094 L347.5171,186.6094 L337.5171,176.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.2236" x="155.5" y="195.1045">&#160;&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.0171" x="155.5" y="211.4561">Internal JWT payload structure</text></g><!--class JWK--><g id="elem_JWK"><rect codeLine="80" fill="#F1F1F1" height="188.875" id="JWK" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="91.3652" x="1898" y="410.6094"/><ellipse cx="1926.4161" cy="426.6094" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1927.3692,423.25 L1927.3692,429.9063 L1929.0879,429.9063 Q1929.6973,429.9063 1929.9629,430.1406 Q1930.2286,430.375 1930.2286,430.7656 Q1930.2286,431.1406 1929.9629,431.375 Q1929.6973,431.6094 1929.0879,431.6094 L1923.9473,431.6094 Q1923.3379,431.6094 1923.0723,431.375 Q1922.8067,431.1406 1922.8067,430.75 Q1922.8067,430.375 1923.0723,430.1406 Q1923.3379,429.9063 1923.9473,429.9063 L1925.6661,429.9063 L1925.6661,423.25 L1923.9473,423.25 Q1923.3379,423.25 1923.0723,423.0156 Q1922.8067,422.7813 1922.8067,422.3906 Q1922.8067,422.0156 1923.0723,421.7813 Q1923.3379,421.5469 1923.9473,421.5469 L1929.0879,421.5469 Q1929.6973,421.5469 1929.9629,421.7813 Q1930.2286,422.0156 1930.2286,422.3906 Q1930.2286,422.7813 1929.9629,423.0156 Q1929.6973,423.25 1929.0879,423.25 L1927.3692,423.25 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="29.5518" x="1943.3974" y="432.3379">JWK</text><line style="stroke:#181818;stroke-width:0.5;" x1="1899" x2="1988.3652" y1="442.6094" y2="442.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.9033" x="1904" y="461.1426">kty: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64.5859" x="1904" y="478.752">use: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.9102" x="1904" y="496.3613">kid: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49.7998" x="1904" y="513.9707">n: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49.7998" x="1904" y="531.5801">e: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68.4824" x="1904" y="549.1895">alg?: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79.3652" x="1904" y="566.7988">x5c?: string[]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68.4756" x="1904" y="584.4082">x5t?: string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1899" x2="1988.3652" y1="591.4844" y2="591.4844"/></g><g id="elem_GMN23"><path d="M2024.5,483.6094 L2024.5,501.6094 L1989.18,505.6094 L2024.5,509.6094 L2024.5,526.3125 A0,0 0 0 0 2024.5,526.3125 L2190.709,526.3125 A0,0 0 0 0 2190.709,526.3125 L2190.709,493.6094 L2180.709,483.6094 L2024.5,483.6094 A0,0 0 0 0 2024.5,483.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2180.709,483.6094 L2180.709,493.6094 L2190.709,493.6094 L2180.709,483.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.2236" x="2030.5" y="502.1045">&#160;&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.209" x="2030.5" y="518.4561">JSON Web Key structure</text></g><!--class JWKS--><g id="elem_JWKS"><rect codeLine="95" fill="#F1F1F1" height="65.6094" id="JWKS" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85.8965" x="1900.5" y="165.1094"/><ellipse cx="1922.2531" cy="181.1094" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1923.2062,177.75 L1923.2062,184.4063 L1924.925,184.4063 Q1925.5343,184.4063 1925.8,184.6406 Q1926.0656,184.875 1926.0656,185.2656 Q1926.0656,185.6406 1925.8,185.875 Q1925.5343,186.1094 1924.925,186.1094 L1919.7843,186.1094 Q1919.175,186.1094 1918.9093,185.875 Q1918.6437,185.6406 1918.6437,185.25 Q1918.6437,184.875 1918.9093,184.6406 Q1919.175,184.4063 1919.7843,184.4063 L1921.5031,184.4063 L1921.5031,177.75 L1919.7843,177.75 Q1919.175,177.75 1918.9093,177.5156 Q1918.6437,177.2813 1918.6437,176.8906 Q1918.6437,176.5156 1918.9093,176.2813 Q1919.175,176.0469 1919.7843,176.0469 L1924.925,176.0469 Q1925.5343,176.0469 1925.8,176.2813 Q1926.0656,176.5156 1926.0656,176.8906 Q1926.0656,177.2813 1925.8,177.5156 Q1925.5343,177.75 1924.925,177.75 L1923.2062,177.75 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="38.8896" x="1937.7538" y="186.8379">JWKS</text><line style="stroke:#181818;stroke-width:0.5;" x1="1901.5" x2="1985.3965" y1="197.1094" y2="197.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73.8965" x="1906.5" y="215.6426">keys: JWK[]</text><line style="stroke:#181818;stroke-width:0.5;" x1="1901.5" x2="1985.3965" y1="222.7188" y2="222.7188"/></g><g id="elem_GMN27"><path d="M2021.5,176.6094 L2021.5,194.6094 L1986.85,198.6094 L2021.5,202.6094 L2021.5,219.3125 A0,0 0 0 0 2021.5,219.3125 L2227.4707,219.3125 A0,0 0 0 0 2227.4707,219.3125 L2227.4707,186.6094 L2217.4707,176.6094 L2021.5,176.6094 A0,0 0 0 0 2021.5,176.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2217.4707,176.6094 L2217.4707,186.6094 L2227.4707,186.6094 L2217.4707,176.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.2236" x="2027.5" y="195.1045">&#160;&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.9707" x="2027.5" y="211.4561">Auth0 JWKS response structure</text></g><!--class jwt--><g id="elem_jwt"><rect codeLine="103" fill="#F1F1F1" height="305.2344" id="jwt" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="893.002" x="2263" y="45.6094"/><ellipse cx="2679.5654" cy="66.9609" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2682.3311,62.8359 Q2682.4873,62.6172 2682.6748,62.5078 Q2682.8623,62.3984 2683.0811,62.3984 Q2683.4561,62.3984 2683.6904,62.6641 Q2683.9248,62.9141 2683.9248,63.5234 L2683.9248,64.9766 Q2683.9248,65.5859 2683.6904,65.8516 Q2683.4561,66.1172 2683.0811,66.1172 Q2682.7373,66.1172 2682.5342,65.9141 Q2682.3311,65.7266 2682.2217,65.2109 Q2682.1748,64.8516 2681.9873,64.6641 Q2681.6592,64.2891 2681.0498,64.0703 Q2680.4404,63.8516 2679.8154,63.8516 Q2679.0498,63.8516 2678.4092,64.1797 Q2677.7842,64.5078 2677.2842,65.2578 Q2676.7998,66.0078 2676.7998,67.0391 L2676.7998,68.1328 Q2676.7998,69.3672 2677.6904,70.1953 Q2678.5811,71.0078 2680.1748,71.0078 Q2681.1123,71.0078 2681.7686,70.7578 Q2682.1592,70.6016 2682.5811,70.1641 Q2682.8467,69.8984 2682.9873,69.8203 Q2683.1436,69.7422 2683.3467,69.7422 Q2683.6748,69.7422 2683.9248,70.0078 Q2684.1904,70.2578 2684.1904,70.6016 Q2684.1904,70.9453 2683.8467,71.3516 Q2683.3467,71.9297 2682.5498,72.2578 Q2681.4717,72.7109 2680.1748,72.7109 Q2678.6592,72.7109 2677.4561,72.0859 Q2676.4717,71.5859 2675.7842,70.5234 Q2675.0967,69.4453 2675.0967,68.1641 L2675.0967,67.0078 Q2675.0967,65.6797 2675.7061,64.5391 Q2676.3311,63.3828 2677.4248,62.7734 Q2678.5186,62.1484 2679.7529,62.1484 Q2680.4873,62.1484 2681.1279,62.3203 Q2681.7842,62.4766 2682.3311,62.8359 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="55.3711" x="2698.0654" y="63.0664">&#171;effectful&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="17.1104" x="2717.1958" y="80.2363">jwt</text><line style="stroke:#181818;stroke-width:0.5;" x1="2264" x2="3155.002" y1="88.3125" y2="88.3125"/><line style="stroke:#181818;stroke-width:0.5;" x1="2264" x2="3155.002" y1="96.3125" y2="96.3125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="738.7939" x="2269" y="114.8457">+async mintInternalToken(auth0Claims: Auth0Claims, targetService: string, secret: string, ttl: number): Promise&lt;string&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="362.5439" x="2269" y="132.4551">-createActorClaim(auth0Claims: Auth0Claims): ActorClaim</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="308.8477" x="2269" y="150.0645">-extractPermissions(claims: Auth0Claims): string[]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="438.8057" x="2269" y="167.6738">-async signJWT(payload: InternalJWT, secret: string): Promise&lt;string&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="413.1572" x="2269" y="185.2832">-async signData(data: string, secret: string): Promise&lt;ArrayBuffer&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="394.4883" x="2269" y="202.8926">-validateSecretStrength(secret: string, secretName: string): void</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="330.6748" x="2269" y="220.502">-parseTokenParts(token: string): [string, string, string]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="881.002" x="2269" y="238.1113">+async verifyInternalToken(token: string, secret: string, expectedAudience: string, previousSecret?: string | undefined): Promise&lt;InternalJWT&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="574.2598" x="2269" y="255.7207">-async verifySignature(data: string, signature: ArrayBuffer, secret: string): Promise&lt;boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="482.4531" x="2269" y="273.3301">-validateInternalClaims(payload: InternalJWT, expectedAudience: string): void</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="175.0889" x="2269" y="290.9395">-generateRequestId(): string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="318.7734" x="2269" y="308.5488">-base64UrlEncode(data: string | ArrayBuffer): string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="278.5439" x="2269" y="326.1582">-base64UrlDecodeToString(str: string): string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="349.3369" x="2269" y="343.7676">-base64UrlDecodeToArrayBuffer(str: string): ArrayBuffer</text></g><g id="elem_GMN31"><path d="M3191,168.6094 L3191,194.6094 L3156.12,198.6094 L3191,202.6094 L3191,227.6641 A0,0 0 0 0 3191,227.6641 L3342.0825,227.6641 A0,0 0 0 0 3342.0825,227.6641 L3342.0825,178.6094 L3332.0825,168.6094 L3191,168.6094 A0,0 0 0 0 3191,168.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3332.0825,168.6094 L3332.0825,178.6094 L3342.0825,178.6094 L3332.0825,168.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65.749" x="3197" y="187.1045">Module: jwt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.6118" x="3197" y="203.4561">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.0825" x="3197" y="219.8076">Stereotype: &#171;effectful&#187;</text></g><!--class logger--><g id="elem_logger"><rect codeLine="125" fill="#F1F1F1" height="76.3125" id="logger" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163.375" x="3377" y="160.1094"/><ellipse cx="3428.752" cy="181.4609" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3431.5176,177.3359 Q3431.6738,177.1172 3431.8613,177.0078 Q3432.0488,176.8984 3432.2676,176.8984 Q3432.6426,176.8984 3432.877,177.1641 Q3433.1113,177.4141 3433.1113,178.0234 L3433.1113,179.4766 Q3433.1113,180.0859 3432.877,180.3516 Q3432.6426,180.6172 3432.2676,180.6172 Q3431.9238,180.6172 3431.7207,180.4141 Q3431.5176,180.2266 3431.4082,179.7109 Q3431.3613,179.3516 3431.1738,179.1641 Q3430.8457,178.7891 3430.2363,178.5703 Q3429.627,178.3516 3429.002,178.3516 Q3428.2363,178.3516 3427.5957,178.6797 Q3426.9707,179.0078 3426.4707,179.7578 Q3425.9863,180.5078 3425.9863,181.5391 L3425.9863,182.6328 Q3425.9863,183.8672 3426.877,184.6953 Q3427.7676,185.5078 3429.3613,185.5078 Q3430.2988,185.5078 3430.9551,185.2578 Q3431.3457,185.1016 3431.7676,184.6641 Q3432.0332,184.3984 3432.1738,184.3203 Q3432.3301,184.2422 3432.5332,184.2422 Q3432.8613,184.2422 3433.1113,184.5078 Q3433.377,184.7578 3433.377,185.1016 Q3433.377,185.4453 3433.0332,185.8516 Q3432.5332,186.4297 3431.7363,186.7578 Q3430.6582,187.2109 3429.3613,187.2109 Q3427.8457,187.2109 3426.6426,186.5859 Q3425.6582,186.0859 3424.9707,185.0234 Q3424.2832,183.9453 3424.2832,182.6641 L3424.2832,181.5078 Q3424.2832,180.1797 3424.8926,179.0391 Q3425.5176,177.8828 3426.6113,177.2734 Q3427.7051,176.6484 3428.9395,176.6484 Q3429.6738,176.6484 3430.3145,176.8203 Q3430.9707,176.9766 3431.5176,177.3359 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="55.3711" x="3447.252" y="177.5664">&#171;effectful&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.917" x="3455.479" y="194.7363">logger</text><line style="stroke:#181818;stroke-width:0.5;" x1="3378" x2="3539.375" y1="202.8125" y2="202.8125"/><line style="stroke:#181818;stroke-width:0.5;" x1="3378" x2="3539.375" y1="210.8125" y2="210.8125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="151.375" x="3383" y="229.3457">+createLogger(): Logger</text></g><g id="elem_GMN35"><path d="M3575,168.6094 L3575,194.6094 L3540.2,198.6094 L3575,202.6094 L3575,227.6641 A0,0 0 0 0 3575,227.6641 L3726.0825,227.6641 A0,0 0 0 0 3726.0825,227.6641 L3726.0825,178.6094 L3716.0825,168.6094 L3575,168.6094 A0,0 0 0 0 3575,168.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3716.0825,168.6094 L3716.0825,178.6094 L3726.0825,178.6094 L3716.0825,168.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85.998" x="3581" y="187.1045">Module: logger</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.6118" x="3581" y="203.4561">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.0825" x="3581" y="219.8076">Stereotype: &#171;effectful&#187;</text></g><!--class middleware--><g id="elem_middleware"><rect codeLine="134" fill="#F1F1F1" height="129.1406" id="middleware" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="916.2168" x="3761.5" y="133.6094"/><ellipse cx="4179.5654" cy="154.9609" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4182.3311,150.8359 Q4182.4873,150.6172 4182.6748,150.5078 Q4182.8623,150.3984 4183.0811,150.3984 Q4183.4561,150.3984 4183.6904,150.6641 Q4183.9248,150.9141 4183.9248,151.5234 L4183.9248,152.9766 Q4183.9248,153.5859 4183.6904,153.8516 Q4183.4561,154.1172 4183.0811,154.1172 Q4182.7373,154.1172 4182.5342,153.9141 Q4182.3311,153.7266 4182.2217,153.2109 Q4182.1748,152.8516 4181.9873,152.6641 Q4181.6592,152.2891 4181.0498,152.0703 Q4180.4404,151.8516 4179.8154,151.8516 Q4179.0498,151.8516 4178.4092,152.1797 Q4177.7842,152.5078 4177.2842,153.2578 Q4176.7998,154.0078 4176.7998,155.0391 L4176.7998,156.1328 Q4176.7998,157.3672 4177.6904,158.1953 Q4178.5811,159.0078 4180.1748,159.0078 Q4181.1123,159.0078 4181.7686,158.7578 Q4182.1592,158.6016 4182.5811,158.1641 Q4182.8467,157.8984 4182.9873,157.8203 Q4183.1436,157.7422 4183.3467,157.7422 Q4183.6748,157.7422 4183.9248,158.0078 Q4184.1904,158.2578 4184.1904,158.6016 Q4184.1904,158.9453 4183.8467,159.3516 Q4183.3467,159.9297 4182.5498,160.2578 Q4181.4717,160.7109 4180.1748,160.7109 Q4178.6592,160.7109 4177.4561,160.0859 Q4176.4717,159.5859 4175.7842,158.5234 Q4175.0967,157.4453 4175.0967,156.1641 L4175.0967,155.0078 Q4175.0967,153.6797 4175.7061,152.5391 Q4176.3311,151.3828 4177.4248,150.7734 Q4178.5186,150.1484 4179.7529,150.1484 Q4180.4873,150.1484 4181.1279,150.3203 Q4181.7842,150.4766 4182.3311,150.8359 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="55.3711" x="4208.1729" y="151.0664">&#171;effectful&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71.5859" x="4200.0654" y="168.2363">middleware</text><line style="stroke:#181818;stroke-width:0.5;" x1="3762.5" x2="4676.7168" y1="176.3125" y2="176.3125"/><line style="stroke:#181818;stroke-width:0.5;" x1="3762.5" x2="4676.7168" y1="184.3125" y2="184.3125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="654.0762" x="3767.5" y="202.8457">+async requestId(c: Context&lt;{ Bindings: Env; Variables: Variables; }, any, {}&gt;, next: Next): Promise&lt;void&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="904.2168" x="3767.5" y="220.4551">+rateLimiter(options: { windowMs: number; maxRequests: number; }): (c: Context&lt;{ Bindings: Env; Variables: Variables; }, any, {}&gt;, next: Next) =...</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="696.8555" x="3767.5" y="238.0645">+async securityHeaders(c: Context&lt;{ Bindings: Env; Variables: Variables; }, any, {}&gt;, next: Next): Promise&lt;void&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="633.0488" x="3767.5" y="255.6738">+async timing(c: Context&lt;{ Bindings: Env; Variables: Variables; }, any, {}&gt;, next: Next): Promise&lt;void&gt;</text></g><g id="elem_GMN39"><path d="M4713,168.6094 L4713,194.6094 L4677.78,198.6094 L4713,202.6094 L4713,227.6641 A0,0 0 0 0 4713,227.6641 L4864.0825,227.6641 A0,0 0 0 0 4864.0825,227.6641 L4864.0825,178.6094 L4854.0825,168.6094 L4713,168.6094 A0,0 0 0 0 4713,168.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M4854.0825,168.6094 L4854.0825,178.6094 L4864.0825,178.6094 L4854.0825,168.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.3335" x="4719" y="187.1045">Module: middleware</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.6118" x="4719" y="203.4561">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.0825" x="4719" y="219.8076">Stereotype: &#171;effectful&#187;</text></g><!--class router--><g id="elem_router"><rect codeLine="146" fill="#F1F1F1" height="129.1406" id="router" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="1127.96" x="4899.5" y="133.6094"/><ellipse cx="5433.5444" cy="154.9609" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M5436.3101,150.8359 Q5436.4663,150.6172 5436.6538,150.5078 Q5436.8413,150.3984 5437.0601,150.3984 Q5437.4351,150.3984 5437.6694,150.6641 Q5437.9038,150.9141 5437.9038,151.5234 L5437.9038,152.9766 Q5437.9038,153.5859 5437.6694,153.8516 Q5437.4351,154.1172 5437.0601,154.1172 Q5436.7163,154.1172 5436.5132,153.9141 Q5436.3101,153.7266 5436.2007,153.2109 Q5436.1538,152.8516 5435.9663,152.6641 Q5435.6382,152.2891 5435.0288,152.0703 Q5434.4194,151.8516 5433.7944,151.8516 Q5433.0288,151.8516 5432.3882,152.1797 Q5431.7632,152.5078 5431.2632,153.2578 Q5430.7788,154.0078 5430.7788,155.0391 L5430.7788,156.1328 Q5430.7788,157.3672 5431.6694,158.1953 Q5432.5601,159.0078 5434.1538,159.0078 Q5435.0913,159.0078 5435.7476,158.7578 Q5436.1382,158.6016 5436.5601,158.1641 Q5436.8257,157.8984 5436.9663,157.8203 Q5437.1226,157.7422 5437.3257,157.7422 Q5437.6538,157.7422 5437.9038,158.0078 Q5438.1694,158.2578 5438.1694,158.6016 Q5438.1694,158.9453 5437.8257,159.3516 Q5437.3257,159.9297 5436.5288,160.2578 Q5435.4507,160.7109 5434.1538,160.7109 Q5432.6382,160.7109 5431.4351,160.0859 Q5430.4507,159.5859 5429.7632,158.5234 Q5429.0757,157.4453 5429.0757,156.1641 L5429.0757,155.0078 Q5429.0757,153.6797 5429.6851,152.5391 Q5430.3101,151.3828 5431.4038,150.7734 Q5432.4976,150.1484 5433.7319,150.1484 Q5434.4663,150.1484 5435.1069,150.3203 Q5435.7632,150.4766 5436.3101,150.8359 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="55.3711" x="5452.0444" y="151.0664">&#171;effectful&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.5723" x="5461.4438" y="168.2363">router</text><line style="stroke:#181818;stroke-width:0.5;" x1="4900.5" x2="6026.46" y1="176.3125" y2="176.3125"/><line style="stroke:#181818;stroke-width:0.5;" x1="4900.5" x2="6026.46" y1="184.3125" y2="184.3125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="318.4043" x="4905.5" y="202.8457">+findServiceRoute(path: string): ServiceRoute | null</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="956.7852" x="4905.5" y="220.4551">+async routeToService(request: Request&lt;unknown, CfProperties&lt;unknown&gt;&gt;, route: ServiceRoute, env: Env, internalToken: string): Promise&lt;Response&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="1115.96" x="4905.5" y="238.0645">-createForwardedRequest(originalRequest: Request&lt;unknown, CfProperties&lt;unknown&gt;&gt;, route: ServiceRoute, internalToken: string): Request&lt;unknown, CfProperties&lt;unknown&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="303.085" x="4905.5" y="255.6738">+getServiceIdentifier(route: ServiceRoute): string</text></g><g id="elem_GMN43"><path d="M6063,168.6094 L6063,194.6094 L6027.79,198.6094 L6063,202.6094 L6063,227.6641 A0,0 0 0 0 6063,227.6641 L6214.0825,227.6641 A0,0 0 0 0 6214.0825,227.6641 L6214.0825,178.6094 L6204.0825,168.6094 L6063,168.6094 A0,0 0 0 0 6063,168.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M6204.0825,168.6094 L6204.0825,178.6094 L6214.0825,178.6094 L6204.0825,168.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.8208" x="6069" y="187.1045">Module: router</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.6118" x="6069" y="203.4561">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.0825" x="6069" y="219.8076">Stereotype: &#171;effectful&#187;</text></g><!--class ServiceRoute--><g id="elem_ServiceRoute"><rect codeLine="158" fill="#F1F1F1" height="100.8281" id="ServiceRoute" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="131.8408" x="6249.5" y="147.6094"/><ellipse cx="6271.6099" cy="163.6094" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M6272.563,160.25 L6272.563,166.9063 L6274.2818,166.9063 Q6274.8912,166.9063 6275.1568,167.1406 Q6275.4224,167.375 6275.4224,167.7656 Q6275.4224,168.1406 6275.1568,168.375 Q6274.8912,168.6094 6274.2818,168.6094 L6269.1412,168.6094 Q6268.5318,168.6094 6268.2662,168.375 Q6268.0005,168.1406 6268.0005,167.75 Q6268.0005,167.375 6268.2662,167.1406 Q6268.5318,166.9063 6269.1412,166.9063 L6270.8599,166.9063 L6270.8599,160.25 L6269.1412,160.25 Q6268.5318,160.25 6268.2662,160.0156 Q6268.0005,159.7813 6268.0005,159.3906 Q6268.0005,159.0156 6268.2662,158.7813 Q6268.5318,158.5469 6269.1412,158.5469 L6274.2818,158.5469 Q6274.8912,158.5469 6275.1568,158.7813 Q6275.4224,159.0156 6275.4224,159.3906 Q6275.4224,159.7813 6275.1568,160.0156 Q6274.8912,160.25 6274.2818,160.25 L6272.563,160.25 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="84.041" x="6287.1899" y="169.3379">ServiceRoute</text><line style="stroke:#181818;stroke-width:0.5;" x1="6250.5" x2="6380.3408" y1="179.6094" y2="179.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76.248" x="6255.5" y="198.1426">prefix: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114.4063" x="6255.5" y="215.752">binding: keyof Env</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119.8408" x="6255.5" y="233.3613">stripPrefix: boolean</text><line style="stroke:#181818;stroke-width:0.5;" x1="6250.5" x2="6380.3408" y1="240.4375" y2="240.4375"/></g><g id="elem_GMN47"><path d="M6417,176.6094 L6417,194.6094 L6381.66,198.6094 L6417,202.6094 L6417,219.3125 A0,0 0 0 0 6417,219.3125 L6568.0698,219.3125 A0,0 0 0 0 6568.0698,219.3125 L6568.0698,186.6094 L6558.0698,176.6094 L6417,176.6094 A0,0 0 0 0 6417,176.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M6558.0698,176.6094 L6558.0698,186.6094 L6568.0698,186.6094 L6558.0698,176.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.2236" x="6423" y="195.1045">&#160;&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.0698" x="6423" y="211.4561">Service route mapping</text></g><!--class Variables--><g id="elem_Variables"><rect codeLine="168" fill="#F1F1F1" height="83.2188" id="Variables" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112.3857" x="6603.5" y="156.6094"/><ellipse cx="6628.4092" cy="172.6094" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M6629.3624,169.25 L6629.3624,175.9063 L6631.0811,175.9063 Q6631.6905,175.9063 6631.9561,176.1406 Q6632.2217,176.375 6632.2217,176.7656 Q6632.2217,177.1406 6631.9561,177.375 Q6631.6905,177.6094 6631.0811,177.6094 L6625.9405,177.6094 Q6625.3311,177.6094 6625.0655,177.375 Q6624.7999,177.1406 6624.7999,176.75 Q6624.7999,176.375 6625.0655,176.1406 Q6625.3311,175.9063 6625.9405,175.9063 L6627.6592,175.9063 L6627.6592,169.25 L6625.9405,169.25 Q6625.3311,169.25 6625.0655,169.0156 Q6624.7999,168.7813 6624.7999,168.3906 Q6624.7999,168.0156 6625.0655,167.7813 Q6625.3311,167.5469 6625.9405,167.5469 L6631.0811,167.5469 Q6631.6905,167.5469 6631.9561,167.7813 Q6632.2217,168.0156 6632.2217,168.3906 Q6632.2217,168.7813 6631.9561,169.0156 Q6631.6905,169.25 6631.0811,169.25 L6629.3624,169.25 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="58.3652" x="6644.6113" y="178.3379">Variables</text><line style="stroke:#181818;stroke-width:0.5;" x1="6604.5" x2="6714.8857" y1="188.6094" y2="188.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100.3857" x="6609.5" y="207.1426">requestId: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88.71" x="6609.5" y="224.752">userId?: string</text><line style="stroke:#181818;stroke-width:0.5;" x1="6604.5" x2="6714.8857" y1="231.8281" y2="231.8281"/></g><g id="elem_GMN51"><path d="M6751,176.6094 L6751,194.6094 L6715.91,198.6094 L6751,202.6094 L6751,219.3125 A0,0 0 0 0 6751,219.3125 L6904.2407,219.3125 A0,0 0 0 0 6904.2407,219.3125 L6904.2407,186.6094 L6894.2407,176.6094 L6751,176.6094 A0,0 0 0 0 6751,176.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M6894.2407,176.6094 L6894.2407,186.6094 L6904.2407,186.6094 L6894.2407,176.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.2236" x="6757" y="195.1045">&#160;&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.2407" x="6757" y="211.4561">Hono context variables</text></g><!--link InternalJWT to ActorClaim--><g id="link_InternalJWT_ActorClaim"><path codeLine="178" d="M60.5,275.1794 C60.5,321.8994 60.5,375.2894 60.5,422.0094 " fill="none" id="InternalJWT-to-ActorClaim" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="60.5,428.0094,64.5,419.0094,60.5,423.0094,56.5,419.0094,60.5,428.0094" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.46" x="32.5" y="348.0845">uses</text></g><!--link JWKS to JWK--><g id="link_JWKS_JWK"><path codeLine="179" d="M1943.5,231.2594 C1943.5,273.8194 1943.5,343.4594 1943.5,404.4694 " fill="none" id="JWKS-to-JWK" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="1943.5,410.4694,1947.5,401.4694,1943.5,405.4694,1939.5,401.4694,1943.5,410.4694" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.46" x="1915.5" y="317.3545">uses</text></g><!--SRC=[lLZVSnet47xdhzZ9Y_4KOpyqJUVYuY604n8RU_XXDvF9UCJT0geFwIBfCDJr_zxL7N0wE8mza_R5FachtTNkjvzM66v2X8_Cu0DRm14qGgOrD3aRApOjbVGz5n6ZJ_3jGjqOnOUnmROlHO__ZN3YY8HSe5b425APYIoLk32eHin7gFj6AbBDf_1O0k1QUw19bHZJICT3PwHaY6VEE48rNKj_-qupKerTWPW7sV2f9AH1K7myCI17Zc6IB2KZUnBoumWKHWer2gFXJG_LZ9EZVmBp3Ic24GaED2hu-gQ48W2hDdUYs4nE4iLwxv5O7An6y8zx4fn77eXuEaHbLJ3ZZBGlewr0a1KkXJxBnUDWOaoalUFZeHJ1b9b9rPyehiC5ILO3d1tRa1wuglRkS6mTlD9OJ46xuy7hx55AytksyfY5Eqca7SBdstwQJ0rbDgBCm0mL7t6V6VByi31lBJ5BybKVz3-Tt3MlBkljZkDfEbqVDDkjJgFbBBGx_LQtKx-u8wDtlLQZs-gVFRzyrnXqkwtENh7hRkkcVJNexPJhzo_SjLRdfjszwbnkgExTDEwQzQ-Dgq6dxy4v6d-IuCZEtzGl1lL- -wgpkN3PwdVRZTxcz3LDjZiVi-dDT50KRHhwjjW37771RSHrKZKhBhcLwfws5YP1AQcwg2FQWqawB6quXp6MbTnwCip4sgcE00tZeIF11Sa87tT3A6VKUjyzRy2xtq_UmRMImn2dq4oKQa0hIVIm52qwGTj-2HPQ2BwY_BTgNd5tZRZ7SobhymYELNk0rJ0fX8WjGia2gopsJQoA_Vvy-oNnzzuiN0hLRh3lSpu9rtVNrp37mlEtVfuevc_DxboG6_O0dtjN7RZ58Np1nNx7UwddkA1Gqv2i5AZjkVH0MrPPB5IVt6dmruE1qrCSZT0tepYirH8xlpnQq77_2PXU21-cvCigu7rvZwBCCaxoN8AgW65gZ6Pvfwo2K06DlaAJZOq9Lr0uz2mAYNFnD5sjaGj7QnTe7rLLXeoTjW-z_9MNgS2vKOIlwupPotxXVYU7Hninq7mi26lb9TOy5v2RnzjpeanXanbM3kZFha0vckfAiSM7c5AbykfcBEIa0tl9pfvHACPcKjwCU3hki2awocUI1pbbrCreJ79ypPJHPMC_dGtVrkfo_xyNe2Qva1PvtEJKRQE228A0Y44z3ZWA5p_KhiouZ7Lwo3EdfuX5mi8OEB5oSbCK-jIp7YM0sQhOpC1gdj2HnVoPp0mbDHbC56TbvKgAiHtmsNNkeWoDKQ0YnLty4QCsxQ1yw71H9ZTa6d_xTQ32bl1ba3yaXSqvsfxzJRJx-xANo9H9r77l9HiTKnkxdPKjGYDg8hMNCeZjTPYEx1rDOKEPtfavvjhYjb2EnzGNFKTlARTS988sZEdNbYkf9iURzSIh79ho80YfFr3u0ivLw_Jw7ZGaeMLkJX_X0nS1nOwOY_gGzt3356TqWTDu_VaUdYh0nA82Zq-r2WZQw467_ZgGjQYgvQnQI5tmAQVJb6MKj3GUFC83sPCFb-l-uprCsNm9FMVoYNJ_H4VXZsgrMX0KAi5OSRFuX2n0fV-dqAIs3GM7uF_VcTn4NGON1tcvoLUXJydOx2a7ej5WUNDthJInbPauvUgk4OM8E0oBa6kNYIvIuV8Io1uiKNCQYtiX7qG56YCA03st34UzcgrHZ185UMj4aMAMHBa2tBrH2kXurUSMjH7dKb7i0WoMpfGbXPkJikxFyNANRo_KcejcraQr0tgfq-EEIhF0wk7ELZDDkOEUzSGBaPFreBdKMzJGXJpYS-S26AQruDakTVrCiglHzL9qUKzkkUdgjhwjVf18l2M-YI9heSYhTPKbBgqfCz_Ug_OpFvAiDLZ3dwIGuAVLJHVuQYMpV42939CNjfxmI9VSfr2rMdD_w_6iQLrA6d6xP5yVoxb_0G00]--></g></svg>