<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="571px" preserveAspectRatio="none" style="width:6681px;height:571px;background:#FFFFFF;" version="1.1" viewBox="0 0 6681 571" width="6681px" zoomAndPan="magnify"><title>Gateway - Class Diagram</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="167.2959" x="3249.9724" y="24.5332">Gateway - Class Diagram</text><!--class ActorClaim--><g id="elem_ActorClaim"><rect codeLine="6" fill="#F1F1F1" height="153.6563" id="ActorClaim" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100.6895" x="10" y="393.1094"/><ellipse cx="25.1055" cy="409.1094" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M26.0586,405.75 L26.0586,412.4063 L27.7773,412.4063 Q28.3867,412.4063 28.6523,412.6406 Q28.918,412.875 28.918,413.2656 Q28.918,413.6406 28.6523,413.875 Q28.3867,414.1094 27.7773,414.1094 L22.6367,414.1094 Q22.0273,414.1094 21.7617,413.875 Q21.4961,413.6406 21.4961,413.25 Q21.4961,412.875 21.7617,412.6406 Q22.0273,412.4063 22.6367,412.4063 L24.3555,412.4063 L24.3555,405.75 L22.6367,405.75 Q22.0273,405.75 21.7617,405.5156 Q21.4961,405.2813 21.4961,404.8906 Q21.4961,404.5156 21.7617,404.2813 Q22.0273,404.0469 22.6367,404.0469 L27.7773,404.0469 Q28.3867,404.0469 28.6523,404.2813 Q28.918,404.5156 28.918,404.8906 Q28.918,405.2813 28.6523,405.5156 Q28.3867,405.75 27.7773,405.75 L26.0586,405.75 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="68.4551" x="39.1289" y="414.8379">ActorClaim</text><line style="stroke:#181818;stroke-width:0.5;" x1="11" x2="109.6895" y1="425.1094" y2="425.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.124" x="16" y="443.6426">iss: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64.5859" x="16" y="461.252">sub: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73.1445" x="16" y="478.8613">role?: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88.6895" x="16" y="496.4707">perms: string[]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70.0342" x="16" y="514.0801">org?: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68.4824" x="16" y="531.6895">uid?: string</text><line style="stroke:#181818;stroke-width:0.5;" x1="11" x2="109.6895" y1="538.7656" y2="538.7656"/></g><g id="elem_GMN3"><path d="M146,448.6094 L146,466.6094 L111.19,470.6094 L146,474.6094 L146,491.3125 A0,0 0 0 0 146,491.3125 L473.1602,491.3125 A0,0 0 0 0 473.1602,491.3125 L473.1602,458.6094 L463.1602,448.6094 L146,448.6094 A0,0 0 0 0 146,448.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M463.1602,448.6094 L463.1602,458.6094 L473.1602,458.6094 L463.1602,448.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.2236" x="152" y="467.1045">&#160;&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306.1602" x="152" y="483.4561">Actor claim - represents "Service X acting for User Y"</text></g><!--class Auth0Claims--><g id="elem_Auth0Claims"><rect codeLine="19" fill="#F1F1F1" height="171.2656" id="Auth0Claims" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="144.2686" x="382.5" y="95.1094"/><ellipse cx="412.3065" cy="111.1094" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M413.2596,107.75 L413.2596,114.4063 L414.9784,114.4063 Q415.5877,114.4063 415.8534,114.6406 Q416.119,114.875 416.119,115.2656 Q416.119,115.6406 415.8534,115.875 Q415.5877,116.1094 414.9784,116.1094 L409.8377,116.1094 Q409.2284,116.1094 408.9627,115.875 Q408.6971,115.6406 408.6971,115.25 Q408.6971,114.875 408.9627,114.6406 Q409.2284,114.4063 409.8377,114.4063 L411.5565,114.4063 L411.5565,107.75 L409.8377,107.75 Q409.2284,107.75 408.9627,107.5156 Q408.6971,107.2813 408.6971,106.8906 Q408.6971,106.5156 408.9627,106.2813 Q409.2284,106.0469 409.8377,106.0469 L414.9784,106.0469 Q415.5877,106.0469 415.8534,106.2813 Q416.119,106.5156 416.119,106.8906 Q416.119,107.2813 415.8534,107.5156 Q415.5877,107.75 414.9784,107.75 L413.2596,107.75 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="79.3652" x="429.5968" y="116.8379">Auth0Claims</text><line style="stroke:#181818;stroke-width:0.5;" x1="383.5" x2="525.7686" y1="127.1094" y2="127.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.124" x="388.5" y="145.6426">iss: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64.5859" x="388.5" y="163.252">sub: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118.8018" x="388.5" y="180.8613">aud: string | string[]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77.8203" x="388.5" y="198.4707">exp: number</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70.0342" x="388.5" y="216.0801">iat: number</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.1582" x="388.5" y="233.6895">scope?: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132.2686" x="388.5" y="251.2988">permissions?: string[]</text><line style="stroke:#181818;stroke-width:0.5;" x1="383.5" x2="525.7686" y1="258.375" y2="258.375"/></g><g id="elem_GMN7"><path d="M561.5,159.1094 L561.5,176.6094 L526.58,180.6094 L561.5,184.6094 L561.5,201.8125 A0,0 0 0 0 561.5,201.8125 L791.2744,201.8125 A0,0 0 0 0 791.2744,201.8125 L791.2744,169.1094 L781.2744,159.1094 L561.5,159.1094 A0,0 0 0 0 561.5,159.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M781.2744,159.1094 L781.2744,169.1094 L791.2744,169.1094 L781.2744,159.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.2236" x="567.5" y="177.6045">&#160;&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208.7744" x="567.5" y="193.9561">Auth0 JWT claims (after verification)</text></g><!--class Env--><g id="elem_Env"><rect codeLine="37" fill="#F1F1F1" height="206.4844" id="Env" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="224.3721" x="826.5" y="77.6094"/><ellipse cx="922.374" cy="93.6094" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M923.3271,90.25 L923.3271,96.9063 L925.0459,96.9063 Q925.6553,96.9063 925.9209,97.1406 Q926.1865,97.375 926.1865,97.7656 Q926.1865,98.1406 925.9209,98.375 Q925.6553,98.6094 925.0459,98.6094 L919.9053,98.6094 Q919.2959,98.6094 919.0303,98.375 Q918.7646,98.1406 918.7646,97.75 Q918.7646,97.375 919.0303,97.1406 Q919.2959,96.9063 919.9053,96.9063 L921.624,96.9063 L921.624,90.25 L919.9053,90.25 Q919.2959,90.25 919.0303,90.0156 Q918.7646,89.7813 918.7646,89.3906 Q918.7646,89.0156 919.0303,88.7813 Q919.2959,88.5469 919.9053,88.5469 L925.0459,88.5469 Q925.6553,88.5469 925.9209,88.7813 Q926.1865,89.0156 926.1865,89.3906 Q926.1865,89.7813 925.9209,90.0156 Q925.6553,90.25 925.0459,90.25 L923.3271,90.25 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="24.124" x="942.874" y="99.3379">Env</text><line style="stroke:#181818;stroke-width:0.5;" x1="827.5" x2="1049.8721" y1="109.6094" y2="109.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151.6963" x="832.5" y="128.1426">AUTH0_DOMAIN: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="168.041" x="832.5" y="145.752">AUTH0_AUDIENCE: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="212.3721" x="832.5" y="163.3613">INTERNAL_JWT_SECRET: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="180.4756" x="832.5" y="180.9707">INTERNAL_JWT_TTL: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="153.248" x="832.5" y="198.5801">ENVIRONMENT?: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="170.3721" x="832.5" y="216.1895">SVC_DAYCOUNT: Fetcher</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="171.165" x="832.5" y="233.7988">SVC_VALUATION: Fetcher</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154.8135" x="832.5" y="251.4082">SVC_METRICS: Fetcher</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150.1514" x="832.5" y="269.0176">SVC_PRICING: Fetcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="827.5" x2="1049.8721" y1="276.0938" y2="276.0938"/></g><g id="elem_GMN11"><path d="M1086,159.1094 L1086,176.6094 L1050.8,180.6094 L1086,184.6094 L1086,201.8125 A0,0 0 0 0 1086,201.8125 L1317.2471,201.8125 A0,0 0 0 0 1317.2471,201.8125 L1317.2471,169.1094 L1307.2471,159.1094 L1086,159.1094 A0,0 0 0 0 1086,159.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1307.2471,159.1094 L1307.2471,169.1094 L1317.2471,169.1094 L1307.2471,159.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.2236" x="1092" y="177.6045">&#160;&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210.2471" x="1092" y="193.9561">Type definitions for Gateway Worker</text></g><!--class ErrorResponse--><g id="elem_ErrorResponse"><rect codeLine="53" fill="#F1F1F1" height="136.0469" id="ErrorResponse" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126.1514" x="1352.5" y="112.6094"/><ellipse cx="1367.5" cy="128.6094" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1368.4531,125.25 L1368.4531,131.9063 L1370.1719,131.9063 Q1370.7813,131.9063 1371.0469,132.1406 Q1371.3125,132.375 1371.3125,132.7656 Q1371.3125,133.1406 1371.0469,133.375 Q1370.7813,133.6094 1370.1719,133.6094 L1365.0313,133.6094 Q1364.4219,133.6094 1364.1563,133.375 Q1363.8906,133.1406 1363.8906,132.75 Q1363.8906,132.375 1364.1563,132.1406 Q1364.4219,131.9063 1365.0313,131.9063 L1366.75,131.9063 L1366.75,125.25 L1365.0313,125.25 Q1364.4219,125.25 1364.1563,125.0156 Q1363.8906,124.7813 1363.8906,124.3906 Q1363.8906,124.0156 1364.1563,123.7813 Q1364.4219,123.5469 1365.0313,123.5469 L1370.1719,123.5469 Q1370.7813,123.5469 1371.0469,123.7813 Q1371.3125,124.0156 1371.3125,124.3906 Q1371.3125,124.7813 1371.0469,125.0156 Q1370.7813,125.25 1370.1719,125.25 L1368.4531,125.25 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="94.1514" x="1381.5" y="134.3379">ErrorResponse</text><line style="stroke:#181818;stroke-width:0.5;" x1="1353.5" x2="1477.6514" y1="144.6094" y2="144.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68.4756" x="1358.5" y="163.1426">type: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.7998" x="1358.5" y="180.752">title: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.5996" x="1358.5" y="198.3613">status: number</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75.4824" x="1358.5" y="215.9707">detail: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101.9443" x="1358.5" y="233.5801">instance?: string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1353.5" x2="1477.6514" y1="240.6563" y2="240.6563"/></g><g id="elem_GMN15"><path d="M1513.5,159.1094 L1513.5,176.6094 L1478.65,180.6094 L1513.5,184.6094 L1513.5,201.8125 A0,0 0 0 0 1513.5,201.8125 L1777.2661,201.8125 A0,0 0 0 0 1777.2661,201.8125 L1777.2661,169.1094 L1767.2661,159.1094 L1513.5,159.1094 A0,0 0 0 0 1513.5,159.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1767.2661,159.1094 L1767.2661,169.1094 L1777.2661,169.1094 L1767.2661,159.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.2236" x="1519.5" y="177.6045">&#160;&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242.7661" x="1519.5" y="193.9561">RFC 7807 Problem Details error response</text></g><!--class InternalJWT--><g id="elem_InternalJWT"><rect codeLine="65" fill="#F1F1F1" height="153.6563" id="InternalJWT" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="107.4619" x="7" y="103.6094"/><ellipse cx="22" cy="119.6094" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M22.9531,116.25 L22.9531,122.9063 L24.6719,122.9063 Q25.2813,122.9063 25.5469,123.1406 Q25.8125,123.375 25.8125,123.7656 Q25.8125,124.1406 25.5469,124.375 Q25.2813,124.6094 24.6719,124.6094 L19.5313,124.6094 Q18.9219,124.6094 18.6563,124.375 Q18.3906,124.1406 18.3906,123.75 Q18.3906,123.375 18.6563,123.1406 Q18.9219,122.9063 19.5313,122.9063 L21.25,122.9063 L21.25,116.25 L19.5313,116.25 Q18.9219,116.25 18.6563,116.0156 Q18.3906,115.7813 18.3906,115.3906 Q18.3906,115.0156 18.6563,114.7813 Q18.9219,114.5469 19.5313,114.5469 L24.6719,114.5469 Q25.2813,114.5469 25.5469,114.7813 Q25.8125,115.0156 25.8125,115.3906 Q25.8125,115.7813 25.5469,116.0156 Q25.2813,116.25 24.6719,116.25 L22.9531,116.25 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="75.4619" x="36" y="125.3379">InternalJWT</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="113.4619" y1="135.6094" y2="135.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.124" x="13" y="154.1426">iss: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64.5859" x="13" y="171.752">sub: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65.3721" x="13" y="189.3613">aud: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77.8203" x="13" y="206.9707">exp: number</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5723" x="13" y="224.5801">rid: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94.9102" x="13" y="242.1895">act: ActorClaim</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="113.4619" y1="249.2656" y2="249.2656"/></g><g id="elem_GMN19"><path d="M149.5,159.1094 L149.5,176.6094 L114.12,180.6094 L149.5,184.6094 L149.5,201.8125 A0,0 0 0 0 149.5,201.8125 L347.5171,201.8125 A0,0 0 0 0 347.5171,201.8125 L347.5171,169.1094 L337.5171,159.1094 L149.5,159.1094 A0,0 0 0 0 149.5,159.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M337.5171,159.1094 L337.5171,169.1094 L347.5171,169.1094 L337.5171,159.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.2236" x="155.5" y="177.6045">&#160;&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.0171" x="155.5" y="193.9561">Internal JWT payload structure</text></g><!--class JWK--><g id="elem_JWK"><rect codeLine="78" fill="#F1F1F1" height="188.875" id="JWK" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="91.3652" x="1810" y="375.6094"/><ellipse cx="1838.4161" cy="391.6094" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1839.3692,388.25 L1839.3692,394.9063 L1841.0879,394.9063 Q1841.6973,394.9063 1841.9629,395.1406 Q1842.2286,395.375 1842.2286,395.7656 Q1842.2286,396.1406 1841.9629,396.375 Q1841.6973,396.6094 1841.0879,396.6094 L1835.9473,396.6094 Q1835.3379,396.6094 1835.0723,396.375 Q1834.8067,396.1406 1834.8067,395.75 Q1834.8067,395.375 1835.0723,395.1406 Q1835.3379,394.9063 1835.9473,394.9063 L1837.6661,394.9063 L1837.6661,388.25 L1835.9473,388.25 Q1835.3379,388.25 1835.0723,388.0156 Q1834.8067,387.7813 1834.8067,387.3906 Q1834.8067,387.0156 1835.0723,386.7813 Q1835.3379,386.5469 1835.9473,386.5469 L1841.0879,386.5469 Q1841.6973,386.5469 1841.9629,386.7813 Q1842.2286,387.0156 1842.2286,387.3906 Q1842.2286,387.7813 1841.9629,388.0156 Q1841.6973,388.25 1841.0879,388.25 L1839.3692,388.25 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="29.5518" x="1855.3974" y="397.3379">JWK</text><line style="stroke:#181818;stroke-width:0.5;" x1="1811" x2="1900.3652" y1="407.6094" y2="407.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.9033" x="1816" y="426.1426">kty: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64.5859" x="1816" y="443.752">use: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.9102" x="1816" y="461.3613">kid: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49.7998" x="1816" y="478.9707">n: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49.7998" x="1816" y="496.5801">e: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68.4824" x="1816" y="514.1895">alg?: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79.3652" x="1816" y="531.7988">x5c?: string[]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68.4756" x="1816" y="549.4082">x5t?: string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1811" x2="1900.3652" y1="556.4844" y2="556.4844"/></g><g id="elem_GMN23"><path d="M1936.5,448.6094 L1936.5,466.6094 L1901.18,470.6094 L1936.5,474.6094 L1936.5,491.3125 A0,0 0 0 0 1936.5,491.3125 L2102.709,491.3125 A0,0 0 0 0 2102.709,491.3125 L2102.709,458.6094 L2092.709,448.6094 L1936.5,448.6094 A0,0 0 0 0 1936.5,448.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2092.709,448.6094 L2092.709,458.6094 L2102.709,458.6094 L2092.709,448.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.2236" x="1942.5" y="467.1045">&#160;&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.209" x="1942.5" y="483.4561">JSON Web Key structure</text></g><!--class JWKS--><g id="elem_JWKS"><rect codeLine="93" fill="#F1F1F1" height="65.6094" id="JWKS" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85.8965" x="1812.5" y="147.6094"/><ellipse cx="1834.2531" cy="163.6094" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1835.2062,160.25 L1835.2062,166.9063 L1836.925,166.9063 Q1837.5343,166.9063 1837.8,167.1406 Q1838.0656,167.375 1838.0656,167.7656 Q1838.0656,168.1406 1837.8,168.375 Q1837.5343,168.6094 1836.925,168.6094 L1831.7843,168.6094 Q1831.175,168.6094 1830.9093,168.375 Q1830.6437,168.1406 1830.6437,167.75 Q1830.6437,167.375 1830.9093,167.1406 Q1831.175,166.9063 1831.7843,166.9063 L1833.5031,166.9063 L1833.5031,160.25 L1831.7843,160.25 Q1831.175,160.25 1830.9093,160.0156 Q1830.6437,159.7813 1830.6437,159.3906 Q1830.6437,159.0156 1830.9093,158.7813 Q1831.175,158.5469 1831.7843,158.5469 L1836.925,158.5469 Q1837.5343,158.5469 1837.8,158.7813 Q1838.0656,159.0156 1838.0656,159.3906 Q1838.0656,159.7813 1837.8,160.0156 Q1837.5343,160.25 1836.925,160.25 L1835.2062,160.25 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="38.8896" x="1849.7538" y="169.3379">JWKS</text><line style="stroke:#181818;stroke-width:0.5;" x1="1813.5" x2="1897.3965" y1="179.6094" y2="179.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73.8965" x="1818.5" y="198.1426">keys: JWK[]</text><line style="stroke:#181818;stroke-width:0.5;" x1="1813.5" x2="1897.3965" y1="205.2188" y2="205.2188"/></g><g id="elem_GMN27"><path d="M1933.5,159.1094 L1933.5,176.6094 L1898.85,180.6094 L1933.5,184.6094 L1933.5,201.8125 A0,0 0 0 0 1933.5,201.8125 L2139.4707,201.8125 A0,0 0 0 0 2139.4707,201.8125 L2139.4707,169.1094 L2129.4707,159.1094 L1933.5,159.1094 A0,0 0 0 0 1933.5,159.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2129.4707,159.1094 L2129.4707,169.1094 L2139.4707,169.1094 L2129.4707,159.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.2236" x="1939.5" y="177.6045">&#160;&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.9707" x="1939.5" y="193.9561">Auth0 JWKS response structure</text></g><!--class jwt--><g id="elem_jwt"><rect codeLine="101" fill="#F1F1F1" height="270.0156" id="jwt" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="750.7939" x="2175" y="45.6094"/><ellipse cx="2520.4614" cy="66.9609" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2523.2271,62.8359 Q2523.3833,62.6172 2523.5708,62.5078 Q2523.7583,62.3984 2523.9771,62.3984 Q2524.3521,62.3984 2524.5864,62.6641 Q2524.8208,62.9141 2524.8208,63.5234 L2524.8208,64.9766 Q2524.8208,65.5859 2524.5864,65.8516 Q2524.3521,66.1172 2523.9771,66.1172 Q2523.6333,66.1172 2523.4302,65.9141 Q2523.2271,65.7266 2523.1177,65.2109 Q2523.0708,64.8516 2522.8833,64.6641 Q2522.5552,64.2891 2521.9458,64.0703 Q2521.3364,63.8516 2520.7114,63.8516 Q2519.9458,63.8516 2519.3052,64.1797 Q2518.6802,64.5078 2518.1802,65.2578 Q2517.6958,66.0078 2517.6958,67.0391 L2517.6958,68.1328 Q2517.6958,69.3672 2518.5864,70.1953 Q2519.4771,71.0078 2521.0708,71.0078 Q2522.0083,71.0078 2522.6646,70.7578 Q2523.0552,70.6016 2523.4771,70.1641 Q2523.7427,69.8984 2523.8833,69.8203 Q2524.0396,69.7422 2524.2427,69.7422 Q2524.5708,69.7422 2524.8208,70.0078 Q2525.0864,70.2578 2525.0864,70.6016 Q2525.0864,70.9453 2524.7427,71.3516 Q2524.2427,71.9297 2523.4458,72.2578 Q2522.3677,72.7109 2521.0708,72.7109 Q2519.5552,72.7109 2518.3521,72.0859 Q2517.3677,71.5859 2516.6802,70.5234 Q2515.9927,69.4453 2515.9927,68.1641 L2515.9927,67.0078 Q2515.9927,65.6797 2516.6021,64.5391 Q2517.2271,63.3828 2518.3208,62.7734 Q2519.4146,62.1484 2520.6489,62.1484 Q2521.3833,62.1484 2522.0239,62.3203 Q2522.6802,62.4766 2523.2271,62.8359 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="55.3711" x="2538.9614" y="63.0664">&#171;effectful&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="17.1104" x="2558.0918" y="80.2363">jwt</text><line style="stroke:#181818;stroke-width:0.5;" x1="2176" x2="2924.7939" y1="88.3125" y2="88.3125"/><line style="stroke:#181818;stroke-width:0.5;" x1="2176" x2="2924.7939" y1="96.3125" y2="96.3125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="738.7939" x="2181" y="114.8457">+async mintInternalToken(auth0Claims: Auth0Claims, targetService: string, secret: string, ttl: number): Promise&lt;string&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="362.5439" x="2181" y="132.4551">-createActorClaim(auth0Claims: Auth0Claims): ActorClaim</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="308.8477" x="2181" y="150.0645">-extractPermissions(claims: Auth0Claims): string[]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="438.8057" x="2181" y="167.6738">-async signJWT(payload: InternalJWT, secret: string): Promise&lt;string&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="413.1572" x="2181" y="185.2832">-async signData(data: string, secret: string): Promise&lt;ArrayBuffer&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="657.125" x="2181" y="202.8926">+async verifyInternalToken(token: string, secret: string, expectedAudience: string): Promise&lt;InternalJWT&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="574.2598" x="2181" y="220.502">-async verifySignature(data: string, signature: ArrayBuffer, secret: string): Promise&lt;boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="482.4531" x="2181" y="238.1113">-validateInternalClaims(payload: InternalJWT, expectedAudience: string): void</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="175.0889" x="2181" y="255.7207">-generateRequestId(): string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="318.7734" x="2181" y="273.3301">-base64UrlEncode(data: string | ArrayBuffer): string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="278.5439" x="2181" y="290.9395">-base64UrlDecodeToString(str: string): string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="349.3369" x="2181" y="308.5488">-base64UrlDecodeToArrayBuffer(str: string): ArrayBuffer</text></g><g id="elem_GMN31"><path d="M2961,151.1094 L2961,176.6094 L2926.22,180.6094 L2961,184.6094 L2961,210.1641 A0,0 0 0 0 2961,210.1641 L3112.0825,210.1641 A0,0 0 0 0 3112.0825,210.1641 L3112.0825,161.1094 L3102.0825,151.1094 L2961,151.1094 A0,0 0 0 0 2961,151.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3102.0825,151.1094 L3102.0825,161.1094 L3112.0825,161.1094 L3102.0825,151.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65.749" x="2967" y="169.6045">Module: jwt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.6118" x="2967" y="185.9561">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.0825" x="2967" y="202.3076">Stereotype: &#171;effectful&#187;</text></g><!--class logger--><g id="elem_logger"><rect codeLine="121" fill="#F1F1F1" height="76.3125" id="logger" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163.375" x="3147" y="142.6094"/><ellipse cx="3198.752" cy="163.9609" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3201.5176,159.8359 Q3201.6738,159.6172 3201.8613,159.5078 Q3202.0488,159.3984 3202.2676,159.3984 Q3202.6426,159.3984 3202.877,159.6641 Q3203.1113,159.9141 3203.1113,160.5234 L3203.1113,161.9766 Q3203.1113,162.5859 3202.877,162.8516 Q3202.6426,163.1172 3202.2676,163.1172 Q3201.9238,163.1172 3201.7207,162.9141 Q3201.5176,162.7266 3201.4082,162.2109 Q3201.3613,161.8516 3201.1738,161.6641 Q3200.8457,161.2891 3200.2363,161.0703 Q3199.627,160.8516 3199.002,160.8516 Q3198.2363,160.8516 3197.5957,161.1797 Q3196.9707,161.5078 3196.4707,162.2578 Q3195.9863,163.0078 3195.9863,164.0391 L3195.9863,165.1328 Q3195.9863,166.3672 3196.877,167.1953 Q3197.7676,168.0078 3199.3613,168.0078 Q3200.2988,168.0078 3200.9551,167.7578 Q3201.3457,167.6016 3201.7676,167.1641 Q3202.0332,166.8984 3202.1738,166.8203 Q3202.3301,166.7422 3202.5332,166.7422 Q3202.8613,166.7422 3203.1113,167.0078 Q3203.377,167.2578 3203.377,167.6016 Q3203.377,167.9453 3203.0332,168.3516 Q3202.5332,168.9297 3201.7363,169.2578 Q3200.6582,169.7109 3199.3613,169.7109 Q3197.8457,169.7109 3196.6426,169.0859 Q3195.6582,168.5859 3194.9707,167.5234 Q3194.2832,166.4453 3194.2832,165.1641 L3194.2832,164.0078 Q3194.2832,162.6797 3194.8926,161.5391 Q3195.5176,160.3828 3196.6113,159.7734 Q3197.7051,159.1484 3198.9395,159.1484 Q3199.6738,159.1484 3200.3145,159.3203 Q3200.9707,159.4766 3201.5176,159.8359 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="55.3711" x="3217.252" y="160.0664">&#171;effectful&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.917" x="3225.479" y="177.2363">logger</text><line style="stroke:#181818;stroke-width:0.5;" x1="3148" x2="3309.375" y1="185.3125" y2="185.3125"/><line style="stroke:#181818;stroke-width:0.5;" x1="3148" x2="3309.375" y1="193.3125" y2="193.3125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="151.375" x="3153" y="211.8457">+createLogger(): Logger</text></g><g id="elem_GMN35"><path d="M3345,151.1094 L3345,176.6094 L3310.2,180.6094 L3345,184.6094 L3345,210.1641 A0,0 0 0 0 3345,210.1641 L3496.0825,210.1641 A0,0 0 0 0 3496.0825,210.1641 L3496.0825,161.1094 L3486.0825,151.1094 L3345,151.1094 A0,0 0 0 0 3345,151.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3486.0825,151.1094 L3486.0825,161.1094 L3496.0825,161.1094 L3486.0825,151.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85.998" x="3351" y="169.6045">Module: logger</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.6118" x="3351" y="185.9561">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.0825" x="3351" y="202.3076">Stereotype: &#171;effectful&#187;</text></g><!--class middleware--><g id="elem_middleware"><rect codeLine="130" fill="#F1F1F1" height="129.1406" id="middleware" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="916.2168" x="3531.5" y="116.1094"/><ellipse cx="3949.5654" cy="137.4609" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3952.3311,133.3359 Q3952.4873,133.1172 3952.6748,133.0078 Q3952.8623,132.8984 3953.0811,132.8984 Q3953.4561,132.8984 3953.6904,133.1641 Q3953.9248,133.4141 3953.9248,134.0234 L3953.9248,135.4766 Q3953.9248,136.0859 3953.6904,136.3516 Q3953.4561,136.6172 3953.0811,136.6172 Q3952.7373,136.6172 3952.5342,136.4141 Q3952.3311,136.2266 3952.2217,135.7109 Q3952.1748,135.3516 3951.9873,135.1641 Q3951.6592,134.7891 3951.0498,134.5703 Q3950.4404,134.3516 3949.8154,134.3516 Q3949.0498,134.3516 3948.4092,134.6797 Q3947.7842,135.0078 3947.2842,135.7578 Q3946.7998,136.5078 3946.7998,137.5391 L3946.7998,138.6328 Q3946.7998,139.8672 3947.6904,140.6953 Q3948.5811,141.5078 3950.1748,141.5078 Q3951.1123,141.5078 3951.7686,141.2578 Q3952.1592,141.1016 3952.5811,140.6641 Q3952.8467,140.3984 3952.9873,140.3203 Q3953.1436,140.2422 3953.3467,140.2422 Q3953.6748,140.2422 3953.9248,140.5078 Q3954.1904,140.7578 3954.1904,141.1016 Q3954.1904,141.4453 3953.8467,141.8516 Q3953.3467,142.4297 3952.5498,142.7578 Q3951.4717,143.2109 3950.1748,143.2109 Q3948.6592,143.2109 3947.4561,142.5859 Q3946.4717,142.0859 3945.7842,141.0234 Q3945.0967,139.9453 3945.0967,138.6641 L3945.0967,137.5078 Q3945.0967,136.1797 3945.7061,135.0391 Q3946.3311,133.8828 3947.4248,133.2734 Q3948.5186,132.6484 3949.7529,132.6484 Q3950.4873,132.6484 3951.1279,132.8203 Q3951.7842,132.9766 3952.3311,133.3359 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="55.3711" x="3978.1729" y="133.5664">&#171;effectful&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71.5859" x="3970.0654" y="150.7363">middleware</text><line style="stroke:#181818;stroke-width:0.5;" x1="3532.5" x2="4446.7168" y1="158.8125" y2="158.8125"/><line style="stroke:#181818;stroke-width:0.5;" x1="3532.5" x2="4446.7168" y1="166.8125" y2="166.8125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="654.0762" x="3537.5" y="185.3457">+async requestId(c: Context&lt;{ Bindings: Env; Variables: Variables; }, any, {}&gt;, next: Next): Promise&lt;void&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="904.2168" x="3537.5" y="202.9551">+rateLimiter(options: { windowMs: number; maxRequests: number; }): (c: Context&lt;{ Bindings: Env; Variables: Variables; }, any, {}&gt;, next: Next) =...</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="696.8555" x="3537.5" y="220.5645">+async securityHeaders(c: Context&lt;{ Bindings: Env; Variables: Variables; }, any, {}&gt;, next: Next): Promise&lt;void&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="633.0488" x="3537.5" y="238.1738">+async timing(c: Context&lt;{ Bindings: Env; Variables: Variables; }, any, {}&gt;, next: Next): Promise&lt;void&gt;</text></g><g id="elem_GMN39"><path d="M4483,151.1094 L4483,176.6094 L4447.78,180.6094 L4483,184.6094 L4483,210.1641 A0,0 0 0 0 4483,210.1641 L4634.0825,210.1641 A0,0 0 0 0 4634.0825,210.1641 L4634.0825,161.1094 L4624.0825,151.1094 L4483,151.1094 A0,0 0 0 0 4483,151.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M4624.0825,151.1094 L4624.0825,161.1094 L4634.0825,161.1094 L4624.0825,151.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.3335" x="4489" y="169.6045">Module: middleware</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.6118" x="4489" y="185.9561">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.0825" x="4489" y="202.3076">Stereotype: &#171;effectful&#187;</text></g><!--class router--><g id="elem_router"><rect codeLine="142" fill="#F1F1F1" height="129.1406" id="router" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="1127.96" x="4669.5" y="116.1094"/><ellipse cx="5203.5444" cy="137.4609" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M5206.3101,133.3359 Q5206.4663,133.1172 5206.6538,133.0078 Q5206.8413,132.8984 5207.0601,132.8984 Q5207.4351,132.8984 5207.6694,133.1641 Q5207.9038,133.4141 5207.9038,134.0234 L5207.9038,135.4766 Q5207.9038,136.0859 5207.6694,136.3516 Q5207.4351,136.6172 5207.0601,136.6172 Q5206.7163,136.6172 5206.5132,136.4141 Q5206.3101,136.2266 5206.2007,135.7109 Q5206.1538,135.3516 5205.9663,135.1641 Q5205.6382,134.7891 5205.0288,134.5703 Q5204.4194,134.3516 5203.7944,134.3516 Q5203.0288,134.3516 5202.3882,134.6797 Q5201.7632,135.0078 5201.2632,135.7578 Q5200.7788,136.5078 5200.7788,137.5391 L5200.7788,138.6328 Q5200.7788,139.8672 5201.6694,140.6953 Q5202.5601,141.5078 5204.1538,141.5078 Q5205.0913,141.5078 5205.7476,141.2578 Q5206.1382,141.1016 5206.5601,140.6641 Q5206.8257,140.3984 5206.9663,140.3203 Q5207.1226,140.2422 5207.3257,140.2422 Q5207.6538,140.2422 5207.9038,140.5078 Q5208.1694,140.7578 5208.1694,141.1016 Q5208.1694,141.4453 5207.8257,141.8516 Q5207.3257,142.4297 5206.5288,142.7578 Q5205.4507,143.2109 5204.1538,143.2109 Q5202.6382,143.2109 5201.4351,142.5859 Q5200.4507,142.0859 5199.7632,141.0234 Q5199.0757,139.9453 5199.0757,138.6641 L5199.0757,137.5078 Q5199.0757,136.1797 5199.6851,135.0391 Q5200.3101,133.8828 5201.4038,133.2734 Q5202.4976,132.6484 5203.7319,132.6484 Q5204.4663,132.6484 5205.1069,132.8203 Q5205.7632,132.9766 5206.3101,133.3359 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="55.3711" x="5222.0444" y="133.5664">&#171;effectful&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.5723" x="5231.4438" y="150.7363">router</text><line style="stroke:#181818;stroke-width:0.5;" x1="4670.5" x2="5796.46" y1="158.8125" y2="158.8125"/><line style="stroke:#181818;stroke-width:0.5;" x1="4670.5" x2="5796.46" y1="166.8125" y2="166.8125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="318.4043" x="4675.5" y="185.3457">+findServiceRoute(path: string): ServiceRoute | null</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="956.7852" x="4675.5" y="202.9551">+async routeToService(request: Request&lt;unknown, CfProperties&lt;unknown&gt;&gt;, route: ServiceRoute, env: Env, internalToken: string): Promise&lt;Response&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="1115.96" x="4675.5" y="220.5645">-createForwardedRequest(originalRequest: Request&lt;unknown, CfProperties&lt;unknown&gt;&gt;, route: ServiceRoute, internalToken: string): Request&lt;unknown, CfProperties&lt;unknown&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="303.085" x="4675.5" y="238.1738">+getServiceIdentifier(route: ServiceRoute): string</text></g><g id="elem_GMN43"><path d="M5833,151.1094 L5833,176.6094 L5797.79,180.6094 L5833,184.6094 L5833,210.1641 A0,0 0 0 0 5833,210.1641 L5984.0825,210.1641 A0,0 0 0 0 5984.0825,210.1641 L5984.0825,161.1094 L5974.0825,151.1094 L5833,151.1094 A0,0 0 0 0 5833,151.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M5974.0825,151.1094 L5974.0825,161.1094 L5984.0825,161.1094 L5974.0825,151.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.8208" x="5839" y="169.6045">Module: router</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.6118" x="5839" y="185.9561">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.0825" x="5839" y="202.3076">Stereotype: &#171;effectful&#187;</text></g><!--class ServiceRoute--><g id="elem_ServiceRoute"><rect codeLine="154" fill="#F1F1F1" height="100.8281" id="ServiceRoute" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="131.8408" x="6019.5" y="130.1094"/><ellipse cx="6041.6099" cy="146.1094" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M6042.563,142.75 L6042.563,149.4063 L6044.2818,149.4063 Q6044.8912,149.4063 6045.1568,149.6406 Q6045.4224,149.875 6045.4224,150.2656 Q6045.4224,150.6406 6045.1568,150.875 Q6044.8912,151.1094 6044.2818,151.1094 L6039.1412,151.1094 Q6038.5318,151.1094 6038.2662,150.875 Q6038.0005,150.6406 6038.0005,150.25 Q6038.0005,149.875 6038.2662,149.6406 Q6038.5318,149.4063 6039.1412,149.4063 L6040.8599,149.4063 L6040.8599,142.75 L6039.1412,142.75 Q6038.5318,142.75 6038.2662,142.5156 Q6038.0005,142.2813 6038.0005,141.8906 Q6038.0005,141.5156 6038.2662,141.2813 Q6038.5318,141.0469 6039.1412,141.0469 L6044.2818,141.0469 Q6044.8912,141.0469 6045.1568,141.2813 Q6045.4224,141.5156 6045.4224,141.8906 Q6045.4224,142.2813 6045.1568,142.5156 Q6044.8912,142.75 6044.2818,142.75 L6042.563,142.75 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="84.041" x="6057.1899" y="151.8379">ServiceRoute</text><line style="stroke:#181818;stroke-width:0.5;" x1="6020.5" x2="6150.3408" y1="162.1094" y2="162.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76.248" x="6025.5" y="180.6426">prefix: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114.4063" x="6025.5" y="198.252">binding: keyof Env</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119.8408" x="6025.5" y="215.8613">stripPrefix: boolean</text><line style="stroke:#181818;stroke-width:0.5;" x1="6020.5" x2="6150.3408" y1="222.9375" y2="222.9375"/></g><g id="elem_GMN47"><path d="M6187,159.1094 L6187,176.6094 L6151.66,180.6094 L6187,184.6094 L6187,201.8125 A0,0 0 0 0 6187,201.8125 L6338.0698,201.8125 A0,0 0 0 0 6338.0698,201.8125 L6338.0698,169.1094 L6328.0698,159.1094 L6187,159.1094 A0,0 0 0 0 6187,159.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M6328.0698,159.1094 L6328.0698,169.1094 L6338.0698,169.1094 L6328.0698,159.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.2236" x="6193" y="177.6045">&#160;&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.0698" x="6193" y="193.9561">Service route mapping</text></g><!--class Variables--><g id="elem_Variables"><rect codeLine="164" fill="#F1F1F1" height="83.2188" id="Variables" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112.3857" x="6373.5" y="139.1094"/><ellipse cx="6398.4092" cy="155.1094" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M6399.3624,151.75 L6399.3624,158.4063 L6401.0811,158.4063 Q6401.6905,158.4063 6401.9561,158.6406 Q6402.2217,158.875 6402.2217,159.2656 Q6402.2217,159.6406 6401.9561,159.875 Q6401.6905,160.1094 6401.0811,160.1094 L6395.9405,160.1094 Q6395.3311,160.1094 6395.0655,159.875 Q6394.7999,159.6406 6394.7999,159.25 Q6394.7999,158.875 6395.0655,158.6406 Q6395.3311,158.4063 6395.9405,158.4063 L6397.6592,158.4063 L6397.6592,151.75 L6395.9405,151.75 Q6395.3311,151.75 6395.0655,151.5156 Q6394.7999,151.2813 6394.7999,150.8906 Q6394.7999,150.5156 6395.0655,150.2813 Q6395.3311,150.0469 6395.9405,150.0469 L6401.0811,150.0469 Q6401.6905,150.0469 6401.9561,150.2813 Q6402.2217,150.5156 6402.2217,150.8906 Q6402.2217,151.2813 6401.9561,151.5156 Q6401.6905,151.75 6401.0811,151.75 L6399.3624,151.75 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="58.3652" x="6414.6113" y="160.8379">Variables</text><line style="stroke:#181818;stroke-width:0.5;" x1="6374.5" x2="6484.8857" y1="171.1094" y2="171.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100.3857" x="6379.5" y="189.6426">requestId: string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88.71" x="6379.5" y="207.252">userId?: string</text><line style="stroke:#181818;stroke-width:0.5;" x1="6374.5" x2="6484.8857" y1="214.3281" y2="214.3281"/></g><g id="elem_GMN51"><path d="M6521,159.1094 L6521,176.6094 L6485.91,180.6094 L6521,184.6094 L6521,201.8125 A0,0 0 0 0 6521,201.8125 L6674.2407,201.8125 A0,0 0 0 0 6674.2407,201.8125 L6674.2407,169.1094 L6664.2407,159.1094 L6521,159.1094 A0,0 0 0 0 6521,159.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M6664.2407,159.1094 L6664.2407,169.1094 L6674.2407,169.1094 L6664.2407,159.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.2236" x="6527" y="177.6045">&#160;&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.2407" x="6527" y="193.9561">Hono context variables</text></g><!--link InternalJWT to ActorClaim--><g id="link_InternalJWT_ActorClaim"><path codeLine="174" d="M60.5,257.8094 C60.5,299.5994 60.5,345.0794 60.5,386.8694 " fill="none" id="InternalJWT-to-ActorClaim" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="60.5,392.8694,64.5,383.8694,60.5,387.8694,56.5,383.8694,60.5,392.8694" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.46" x="32.5" y="321.8345">uses</text></g><!--link JWKS to JWK--><g id="link_JWKS_JWK"><path codeLine="175" d="M1855.5,213.8194 C1855.5,253.0294 1855.5,313.9394 1855.5,369.5694 " fill="none" id="JWKS-to-JWK" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="1855.5,375.5694,1859.5,366.5694,1855.5,370.5694,1851.5,366.5694,1855.5,375.5694" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.46" x="1827.5" y="291.1845">uses</text></g><!--SRC=[lLZTS-8s47_dhzYvbv0f8NdezJfEoWq7v8vSGZ90ajvqEXbXBw36I3v99j0q_tjNDiOoc7pCNFl2MAlLxc-_9Gmt8S9dPl21BU40MY7J6jgSJHIRLIhwdek8qIVuTgDfZEAZs63NbsB0_qOuSbX2Bj0i8mIfp5HMAbmOL6Fc8pHz8nM9vZDuh01mhJtG94fCQANZaRDICiIFpZf2DLjp__4dKQIQk0mn3_BbKqL8Ww3uP6f0ZXt5n5b9LjOImd402YE56eNHy6w0Qiu9wE_0V4E2O4oCrneLV7jNGH605LkmA3RJeqImVj4a5WVP2lvnBS55v868PoDKLWGppahxCjfo16dXKkYF1N_iJOs9j7TuE98Yc34phVjJnNMu9CvwWFD3wz8zLzIB9nnTUszK5fFJxdZmDdqKqkAPhJZcxau2QPTmTZjCWwcXoiOK6PYZucFkCqF8zqlZrX7p95xDw-6NexlsvKMpstEGfkJcTRlRwRKwpaQtD-pqUytpEr9wD-Yq-ftXhjtXyDpPwlHkkltBtaMdDtHTChXftRMRtrgNrpqIT8h6doPXj_IRvlbrSzYzx6rkN7I6_Mvhi4c-8cAtzpadRtgFZBPU6zhQ373C1RSEqacIPwL_AzKz7ItrcL9IzL57T0OJxzagTumnjecuwM-OYRMJp04QnaE7WmlY4JxkZdX1gKNVFst1Xr-FFi2LagCGPz1EX6f0oqdLl68jiw1hlmGBRSQyeLgtIbHnTuzQXUTsc4qJ7AtMW6oPv6t4bg5aWHKM-oPMvRZFRhycUE_DqkrusdNsVG6JSB6xMCD2qroyzujrlNXlTiU2O5W3pWQNFRZ54Np5vSl01oboN9AhQKbQIiGEt6gc8raKIyKd8mZ-UZ1mSeBZCVfc78UDHgBdfqURTDn_0gQNmeSPOSaSFfJtAAeiRo6UsqzgO9YQe5cDWCm9DT3eApJvsfWmIuLzpsOXjKWyINSR1E5W3O7EKLNbcR5JzxvNd52v25mOHVbrbJVYgbzwtedXmOOFD9y8ohNgAjSyDo4tpNl1ebnWcnbM3UXdbwCSIKsbsF9JJA5IZP8O9TrwMOoIiR-xOq3bI677e1a774KUBKUfOsIP3QdI0Ld2R7fjcfBHoSqv-6TC74aQhamKDSrPo4akPb3IOEs8mpCcpIKF2e8dA52Hu3v-Zr6RRb3TTuewvninZR_yVAt2Zl1bK3IIhY2EQI-SRwCzFvI3XATAh0wyrnnqL6sSTdQsEWFLE8cza45ivqgwiiEEt8Oo7Jw55h3L948vcT1zuBa-aHRfUS9etPX-RK599JbereGt0Phn80Xfq2fyHVDIw_3w7hGaPSl2d3p29ou2yXsr01hent3356Sq2Mcz_Zo6fnemiQp1urEZ1e8EUj2ZNoTbRLOLoz6cr3cVSRAcAgFaRk318poGFlbmiHxanp1ZYrNgESGdalq3WS9lzNgzn2bKWh7YPla5MO1A_q-kINKRSWwb_t-dSZFhydHnCgz0V5FsAHcR5yg1ReN1QWJsBJTrApDrojNTenOYuZ0ioroxJUqYPQwk4jc3LTQSnE9Uo0THWzQO743F3CDHPzG6-IWHKDH6BLBC4o_NWBl3egGTPnV6idbyAXNvBi1W1QOgoTsSXFL_3CfTs5ufjU3D_3xI3UY5IeyQAiqIhVixxsnfo9tiMHDUcJdvPQuGUfirz6uUyuKp04PfBNZskhT-RzZTw6h5kfgJMp1TsHPRzX1Fq5A_YIAheGpLkieIIEkMMRmdg-upVmwi9LZ5NwIGuAVLJGCysyarxr4Wm-HbgQSyqXNtJL6lDzp_E3ohMbUI6wtTijVu5UrV]--></g></svg>